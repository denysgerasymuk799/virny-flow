FROM ubuntu:22.04

MAINTAINER Zeyuan Shang "zeyuanxy@gmail.com"

# update
RUN apt-get -y update

# install essentials
RUN apt-get -y install \
        wget \
        g++ \
        gcc \
        git

# install miniconda
RUN wget https://repo.continuum.io/miniconda/Miniconda3-latest-Linux-x86_64.sh -O miniconda.sh
ENV DEPS_DIR=/usr/deps
RUN mkdir -p ${DEPS_DIR}
RUN bash miniconda.sh -b -p ${DEPS_DIR}/miniconda
ENV PATH=${DEPS_DIR}/miniconda/bin:$PATH

# install dependencies through conda
RUN conda install -q -y python pip gxx_linux-64 gcc_linux-64 swig

# install Python libraries
ADD requirements.txt .
RUN pip install -r requirements.txt
ADD requirements-build.txt .
RUN pip install -r requirements-build.txt
